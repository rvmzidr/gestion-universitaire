<div class="page-header">
    <h1>Liste des √©tudiants</h1>
    <div style="display: flex; gap: 10px;">
        {{#if (eq user.role 'admin')}}
        <a href="/etudiants/create" class="btn btn-primary">+ Ajouter un √©tudiant</a>
        <a href="/etudiants/import" class="btn btn-info">üì• Importer CSV</a>
        {{/if}}
    </div>
</div>

{{#if success}}
<div class="alert alert-success">
    {{#if (eq success 'create')}}√âtudiant cr√©√© avec succ√®s{{/if}}
    {{#if (eq success 'update')}}√âtudiant modifi√© avec succ√®s{{/if}}
    {{#if (eq success 'delete')}}√âtudiant supprim√© avec succ√®s{{/if}}
</div>
{{/if}}

{{#if missingDepartement}}
<div class="alert alert-warning">
    Aucun d√©partement n'est associ√© √† votre compte directeur. Contactez un administrateur pour acc√©der aux donn√©es de votre d√©partement.
</div>
{{/if}}

<div class="table-container compact-table">
    <table class="data-table">
        <thead>
            <tr>
                <th>CIN</th>
                <th>Nom</th>
                <th>Pr√©nom</th>
                <th>Email</th>
                <th>Groupe</th>
                <th>Sp√©cialit√©</th>
                <th>Emploi du temps</th>
                {{#if (eq user.role 'admin')}}
                <th>Actions</th>
                {{/if}}
            </tr>
        </thead>
        <tbody>
            {{#each etudiants}}
            <tr>
                <td>{{this.cin}}</td>
                <td>{{this.nom}}</td>
                <td>{{this.prenom}}</td>
                <td>{{this.email}}</td>
                <td>{{this.groupe_nom}}</td>
                <td>{{this.specialite_nom}}</td>
                <td>
                    <a href="/emplois/etudiant/{{this.id}}" class="btn btn-sm btn-success">üìÖ Voir emploi</a>
                </td>
                {{#if (eq ../user.role 'admin')}}
                <td class="actions">
                    <a href="/etudiants/edit/{{this.id}}" class="btn btn-sm btn-edit">Modifier</a>
                    <form action="/etudiants/delete/{{this.id}}" method="POST" style="display:inline;" 
                          onsubmit="return confirm('√ätes-vous s√ªr ?');">
                        <button type="submit" class="btn btn-sm btn-delete">Supprimer</button>
                    </form>
                </td>
                {{/if}}
            </tr>
            {{else}}
            <tr>
                <td colspan="{{#if (eq user.role 'admin')}}8{{else}}7{{/if}}" class="text-center">Aucun √©tudiant trouv√©</td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>